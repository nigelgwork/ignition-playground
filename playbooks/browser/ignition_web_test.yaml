name: "Ignition Gateway Web Test"
version: "1.0"
description: "Test Ignition Gateway web interface navigation"

parameters:
  - name: gateway_url
    type: string
    required: true
    description: "Gateway URL (e.g., http://localhost:8088)"

  - name: gateway_credential
    type: credential
    required: true
    description: "Gateway admin credential"

steps:
  - id: navigate_home
    name: "Navigate to Gateway Homepage"
    type: browser.navigate
    parameters:
      url: "{{ parameter.gateway_url }}"
      wait_until: "networkidle"
    timeout: 30

  - id: screenshot_home
    name: "Screenshot Gateway Homepage"
    type: browser.screenshot
    parameters:
      name: "gateway_home"
      full_page: true
    timeout: 10

  - id: navigate_config
    name: "Navigate to Gateway Config"
    type: browser.navigate
    parameters:
      url: "{{ parameter.gateway_url }}/web/config"
      wait_until: "networkidle"
    timeout: 30

  - id: wait_login_form
    name: "Wait for Login Form"
    type: browser.wait
    parameters:
      selector: "input[name='username'], #username"
    timeout: 10
    on_failure: continue

  - id: fill_username
    name: "Fill Username"
    type: browser.fill
    parameters:
      selector: "input[name='username'], #username"
      value: "{{ credential.gateway_credential.username }}"
    timeout: 10
    on_failure: continue

  - id: fill_password
    name: "Fill Password"
    type: browser.fill
    parameters:
      selector: "input[name='password'], #password"
      value: "{{ credential.gateway_credential.password }}"
    timeout: 10
    on_failure: continue

  - id: click_login
    name: "Click Login Button"
    type: browser.click
    parameters:
      selector: "button[type='submit'], input[type='submit']"
    timeout: 10
    on_failure: continue

  - id: wait_config_page
    name: "Wait for Config Page to Load"
    type: utility.sleep
    parameters:
      seconds: 5

  - id: screenshot_config
    name: "Screenshot Gateway Config"
    type: browser.screenshot
    parameters:
      name: "gateway_config"
      full_page: true
    timeout: 10

  - id: navigate_modules
    name: "Navigate to Modules Page"
    type: browser.navigate
    parameters:
      url: "{{ parameter.gateway_url }}/web/config/system.modules"
      wait_until: "networkidle"
    timeout: 30
    on_failure: continue

  - id: screenshot_modules
    name: "Screenshot Modules Page"
    type: browser.screenshot
    parameters:
      name: "gateway_modules"
      full_page: true
    timeout: 10
    on_failure: continue

metadata:
  author: "Ignition Toolkit"
  category: "browser"
  tags: ["browser", "ignition", "gateway", "web-interface"]
